<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>AMS - STORE</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="" name="keywords" />
    <meta content="" name="description" />

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon" />

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600&family=Inter:wght@700;800&display=swap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />

    <!-- Icon Font Stylesheet -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet" />
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet" />

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet" />

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet" />

    <style>
      .icon-atas {
        color: black !important;
        font-size: 25px;
        width: 10% !important;
        margin-left: -90px;
      }
    </style>
  </head>

  <body>
    <!-- Navbar -->
    <div class="container-xxl bg-white p-0">
      <!-- Navbar Start -->
      <nav
        style="height: 70px"
        class="navbar navbar-expand-lg bg-white navbar-light py-0 px-10"
      >
        <a
          href="index.html"
          class="navbar-brand d-flex align-items-center text-center"
        >
          <div>
            <img
              class="img-fluid"
              src="img/logo-aki.png"
              alt="Icon"
              style="width: 120px; margin-left: 80px"
            />
          </div>
        </a>
        <button
          type="button"
          class="navbar-toggler"
          data-bs-toggle="collapse"
          data-bs-target="#navbarCollapse"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
          <div class="navbar-nav ms-auto">
            <a
              href="https://www.instagram.com/akikita.id"
              class="nav-item nav-link active"
            >
              <i class="icon-atas fab fa-instagram" aria-hidden="true"></i>
            </a>
            <a
              href="https://akikita.id/redirect_to_whatsapp/"
              class="nav-item nav-link active"
            >
              <i class="icon-atas fab fa-whatsapp" aria-hidden="true"></i>
            </a>
          </div>
        </div>
      </nav>
    </div>
    <!-- Navbar End -->
    <div class="gradient-bar"></div>

    <!-- Banner -->
    <div class="container-fluid header bg-white p-0">
      <div class="row g-0 align-items-center flex-column-reverse flex-md-row">
        <div class="col-md-1 mt-lg-1">
          <img src="img/banner-bener-2.png" alt="" />
          <button
            style="margin-top: -126px; margin-left: 85px; padding: 12px 20px"
            class="btn btn-primary position-absolute"
          >
            <i
              style="margin-left: -10px; font-size: 20px; width: 30px"
              class="fab fa-whatsapp"
            ></i>
            Kontak Sekarang
          </button>
        </div>
      </div>
    </div>

    <div class="gradient-bar"></div>

    <!-- Search Start -->
    <div
      class="container-filter container-fluid wow fadeIn"
      data-wow-delay="0.1s"
      style="padding: 17px; background-color: black"
    >
      <h6 style="color: white; font-size: 20px; margin-left: 68px">
        TEMUKAN AKIMU <i style="margin-right: 10px" class="fas fa-search"></i>
      </h6>
      <p style="color: white; margin-left: 70px">Pilih Kendaraanmu</p>
      <div class="container">
        <div class="row g-2">
          <div class="col-md-10">
            <div class="row g-2">
              <!-- Brand Select -->
              <div class="col-md-2">
                <select id="brandSelect" class="form-select border-0 py-3">
                  <option selected>Pilih Brand</option>
                </select>
              </div>

              <!-- Model Select -->
              <div class="col-md-3">
                <select
                  id="modelSelect"
                  class="form-select border-0 py-3"
                  disabled
                >
                  <option selected>Pilih Model</option>
                </select>
              </div>

              <!-- Fuel Select -->
              <div class="col-md-2">
                <select
                  id="fuelSelect"
                  class="form-select border-0 py-3"
                  disabled
                >
                  <option selected>Pilih Fuel</option>
                </select>
              </div>

              <!-- Transmission Select -->
              <div class="col-md-3">
                <select
                  id="transmissionSelect"
                  class="form-select border-0 py-3"
                  disabled
                >
                  <option selected>Pilih Type Transmission</option>
                </select>
              </div>

              <!-- Year Select -->
              <div class="col-md-2">
                <select
                  id="yearSelect"
                  class="form-select border-0 py-3"
                  disabled
                >
                  <option selected>Pilih Tahun</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Search Button -->
          <div class="col-md-2">
            <button
              style="color: white; background-color: #87ce34"
              class="btn btn-dark border-0 w-100 py-2"
              id="searchButton"
            >
              Cari
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- Search End -->

    <div class="gradient-bar"></div>

    <!-- Search js  -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Styles -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css"
    />

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
      $(document).ready(function () {
        $("#brandSelect").select2({
          theme: "bootstrap-5",
        });
        $("#modelSelect").select2({
          theme: "bootstrap-5",
        });
        $("#fuelSelect").select2({
          theme: "bootstrap-5",
        });
        $("#transmissionSelect").select2({
          theme: "bootstrap-5",
        });
        $("#yearSelect").select2({
          theme: "bootstrap-5",
        });

        // Mengambil data brand saat halaman dimuat
        $.ajax({
          url: "https://ams.akikita.web.id/api/filter/brand",
          method: "GET",
          dataType: "json",
          success: function (response) {
            console.log(response);
            const brandSelect = $("#brandSelect");
            // brandSelect.append(`<option value=""></option>`);

            if (response.status === "success" && response.data.length > 0) {
              response.data.forEach(function (brandName) {
                brandSelect.append(
                  `<option value="${brandName}">${brandName}</option>`
                );
              });
            }
          },
          error: function () {
            alert("Gagal mengambil data brand");
          },
        });

        // Mengambil data model setelah memilih brand
        $("#brandSelect").change(function () {
          const selectedBrand = $(this).val();
          const modelSelect = $("#modelSelect");
          const fuelSelect = $("#fuelSelect");
          const transmissionSelect = $("#transmissionSelect");
          const yearSelect = $("#yearSelect");

          if (selectedBrand) {
            modelSelect
              .prop("disabled", false)
              .html("<option selected>Loading...</option>");
            fuelSelect
              .prop("disabled", true)
              .html("<option selected>Pilih Fuel</option>");
            transmissionSelect
              .prop("disabled", true)
              .html("<option selected>Pilih Type Transmission</option>");
            yearSelect
              .prop("disabled", true)
              .html("<option selected>Pilih Tahun</option>");

            $.ajax({
              url: `https://ams.akikita.web.id/api/filter/brand/${selectedBrand}`,
              method: "GET",
              dataType: "json",
              success: function (response) {
                modelSelect
                  .empty()
                  .append(`<option value="">Pilih Model</option>`);
                if (response.status === "success" && response.data.length > 0) {
                  response.data.forEach(function (modelName) {
                    modelSelect.append(
                      `<option value="${modelName}">${modelName}</option>`
                    );
                  });
                } else {
                  modelSelect.append(
                    `<option value="">Model tidak ditemukan</option>`
                  );
                }
              },
              error: function () {
                alert("Gagal mengambil data model");
                modelSelect
                  .prop("disabled", true)
                  .html("<option selected>Pilih Model</option>");
                fuelSelect
                  .prop("disabled", true)
                  .html("<option selected>Pilih Fuel</option>");
                transmissionSelect
                  .prop("disabled", true)
                  .html("<option selected>Pilih Type Transmission</option>");
                yearSelect
                  .prop("disabled", true)
                  .html("<option selected>Pilih Tahun</option>");
              },
            });
          } else {
            modelSelect
              .prop("disabled", true)
              .html("<option selected>Pilih Model</option>");
            fuelSelect
              .prop("disabled", true)
              .html("<option selected>Pilih Fuel</option>");
            transmissionSelect
              .prop("disabled", true)
              .html("<option selected>Pilih Type Transmission</option>");
            yearSelect
              .prop("disabled", true)
              .html("<option selected>Pilih Tahun</option>");
          }
        });

        // Mengaktifkan fuel select setelah memilih model
        $("#modelSelect").change(function () {
          const selectedModel = $(this).val();
          const fuelSelect = $("#fuelSelect");

          if (selectedModel) {
            // Aktifkan dropdown fuel dan isi dengan opsi
            fuelSelect.prop("disabled", false);
            fuelSelect.empty(); // Hapus opsi yang ada sebelumnya
            fuelSelect.append('<option value="">Pilih Fuel</option>');
            fuelSelect.append('<option value="none">None</option>');
            fuelSelect.append('<option value="bensin">Bensin</option>');
            fuelSelect.append('<option value="diesel">Diesel</option>');
          } else {
            // Nonaktifkan dropdown fuel jika tidak ada model yang dipilih
            fuelSelect
              .prop("disabled", true)
              .html("<option selected>Pilih Fuel</option>");
          }
        });

        // Mengaktifkan transmission select setelah memilih fuel
        $("#fuelSelect").change(function () {
          const selectedFuel = $(this).val();
          const transmissionSelect = $("#transmissionSelect");

          if (selectedFuel) {
            // Aktifkan dropdown transmission dan isi dengan opsi
            transmissionSelect.prop("disabled", false);
            transmissionSelect.empty(); // Hapus opsi yang ada sebelumnya
            transmissionSelect.append(
              '<option value="">Pilih Type Transmission</option>'
            );
            transmissionSelect.append('<option value="none">None</option>');
            transmissionSelect.append('<option value="matic">Matic</option>');
          } else {
            // Nonaktifkan dropdown transmission jika tidak ada fuel yang dipilih
            transmissionSelect
              .prop("disabled", true)
              .html("<option selected>Pilih Type Transmission</option>");
          }
        });

        // Mengaktifkan year select setelah memilih transmission
        $("#transmissionSelect").change(function () {
          const selectedTransmission = $(this).val();
          const yearSelect = $("#yearSelect");
          if (selectedTransmission) {
            yearSelect.prop("disabled", false);
            const currentYear = new Date().getFullYear();
            yearSelect.empty().append(`<option value="">Pilih Tahun</option>`);
            for (let year = 1945; year <= currentYear; year++) {
              yearSelect.append(`<option value="${year}">${year}</option>`);
            }
          } else {
            yearSelect
              .prop("disabled", true)
              .html("<option selected>Pilih Tahun</option>");
          }
        });
        $("#searchButton").click(function () {
          // Ambil nilai model yang dipilih (misal dari input atau dropdown)
          const selectedModel = $("#modelSelect").val();

          // Periksa apakah model sudah dipilih
          if (selectedModel) {
            // Pindah ke halaman property-list.html dengan query parameter
            window.location.href = `detail_barang.html?model=${encodeURIComponent(
              selectedModel
            )}`;
          } else {
            alert("Model belum dipilih");
          }
        });
      });
    </script>

    <!-- Catalog container -->
    <div
      class="kontendetail w-full d-none d-flex justify-content-around gap-5"
      id="container-catalog-detail"
      style="
        background-image: url('img/bg-aki.png');
        background-size: cover;
        background-position: bottom;
      "
    >
      <div class="d-flex justify-content-between p-2">
        <div class="fotoaki">
          <img
            id="battery-image"
            alt=""
            onerror="this.onerror=null;this.src='img/noimage.jpg';"
            src="img/noimage.jpg"
            height="350"
            width="350"
          />
        </div>

        <div class="product-aki">
          <div class="judul-aki"><span id="battery-name"></span></div>

          <div class="harga-aki">
            Harga
            <br />
            <h4>Rp <span id="battery-price">0</span></h4>
            <hr />
            <h4>Pesan Sekarang Di</h4>
          </div>

          <div class="order-wa pt-2">
            <button class="fs-5">
              <i class="fab fa-whatsapp ml-5"></i>
              Whatsapp
            </button>
          </div>

          <div class="order-tokped pt-1">
            <button
              class="fs-5 btn-tokopedia"
              data-url=""
              onclick="window.open(this.getAttribute('data-url'))"
            >
              <img class="ml-5" src="img/tokped-logo.png" alt="" />
              Tokopedia
            </button>
          </div>
        </div>
      </div>

      <!-- Specifications Table -->
      <div class="specifications p-3 pb-5 bg-light">
        <span class="fs-4 fw-bold">Spesifikasi Produk</span>
        <table class="h-100 mb-2">
          <tr class="tabel-1">
            <td>Garansi</td>
            <td><span id="battery-warranty">0</span> Bulan</td>
          </tr>
          <tr>
            <td>Standard CCA</td>
            <td><span id="battery-cca"></span> A</td>
          </tr>
          <tr class="tabel-1">
            <td>Kapasitas</td>
            <td><span id="battery-capacity"></span> Ah</td>
          </tr>
          <tr>
            <td>Voltase</td>
            <td>12V</td>
          </tr>
          <tr class="tabel-1">
            <td>Dimensi</td>
            <td>
              <span id="battery-length"></span> X
              <span id="battery-width"></span> X
              <span id="battery-height"></span>
            </td>
          </tr>
          <tr>
            <td>Nama Lain</td>
            <td><span id="battery-alt-name"></span></td>
          </tr>
        </table>
      </div>
    </div>
    <!-- Closing div for .kontendetail -->

    <div class="container p-2" id="container-catalog">
      <div
        class="row row-cols-6 justify-content-between"
        id="container-row-catalog"
      ></div>
    </div>

    <script type="module">
      import {
        fetchCatalogs,
        fetchCatalogDetails,
      } from "./service/catalogService.js";

      $(function () {
        const openDetailCatalog = async (batteryId) => {
          try {
            const details = await fetchCatalogDetails(batteryId);
            console.log(details);

            // Replace the catalog detail value.
            $("#battery-image").attr(
              "src",
              "https://ams.akikita.web.id/storage/image/battery/" +
                details.image
            );
            $("#battery-name").text(details.name);
            $("#battery-price").text(
              parseFloat(details.price_retail).toLocaleString()
            );
            $("#battery-warranty").text(details.warranty);
            $("#battery-cca").text(details.standard_cca);
            $("#battery-capacity").text(details.capacity);
            $("#battery-length").text(details.dimension_length);
            $("#battery-width").text(details.dimension_width);
            $("#battery-height").text(details.dimension_height);
            $("#battery-alt-name").text(details.name_alternate);

            const tokopediaUrl = details.battery_url.find(
              (url) => url.platform === "TOKOPEDIA"
            );
            if (tokopediaUrl) {
              $(".btn-tokopedia").removeClass("d-none");
              $(".btn-tokopedia").attr("data-url", tokopediaUrl.url);
            } else {
              $(".btn-tokopedia").addClass("d-none");
            }

            // Show the catalog detail container.
            $("#container-catalog-detail").removeClass("d-none");
          } catch (error) {
            console.error("Error loading catalog details:", error);
          }
        };

        const loadCatalogs = async () => {
          try {
            const catalogs = await fetchCatalogs();
            catalogs.forEach((catalog) => {
              const catalogCard = `
                <div class="product-card m-2 p-2 card col bg-dark">
                  <div class="product-image">
                    <img
                      alt="${catalog.name} Battery Picture"
                      src="https://ams.akikita.web.id/storage/image/battery/compressed/${catalog.image}"
                      onerror="this.onerror=null;this.src='img/noimage.jpg';"
                      height="300"
                      width="300"
                    />
                  </div>

                  <div class="detail-katalog rounded">
                    <h2>${catalog.name}</h2>
                    <table class="specs-katalog" align="center">
                      <tr class="detail1">
                        <td>Ketegangan: 12V</td>
                      </tr>
                      <tr class="detail2">
                        <td>Kapasitas: ${catalog.capacity}Ah</td>
                      </tr>
                    </table>
                    <button class="btn btn-detail" data-id="${catalog.id}">Lihat Detail Produk</button>
                  </div>
                </div>
              `;
              $("#container-row-catalog").append(catalogCard);
            });

            $(".btn-detail").on("click", function () {
              openDetailCatalog($(this).data("id"));
            });
          } catch (error) {
            console.error("Error loading catalogs:", error);
          }
        };

        loadCatalogs();

        $(".order-wa button").on("click", function () {
          window.open("https://api.whatsapp.com/send?phone=6282228800175");
        });
      });
    </script>

    <!-- Footer -->
    <div class="footer">
      <div class="container">
        <div class="column">
          <img src="img/logo-kecil.png" alt="Akikita.id logo" />
          <p>
            <strong>Akikita.id</strong> adalah layanan antar pasang aki untuk
            kendaraan di wilayah Bandung. Teknisi terlatih kami siap melayani
            Anda.
          </p>
          <h3>Kantor Utama</h3>
          <p class="contact-info">
            <i class="fas fa-map-marker-alt"></i> Jalan Raya Daan Mogot KM. 18,
            Green Sedayu Bizpark DM5 Nomor 58, Provinsi DKI Jakarta
          </p>
          <p class="contact-info">
            <i class="fas fa-phone"></i> +62-8222-8800-175
          </p>
          <p class="contact-info">
            <i class="fas fa-envelope"></i> akikita.id@gmail.com
          </p>
        </div>
        <div style="margin-left: 100px" class="column">
          <h3>Navigasi</h3>
          <p><a href="#">Halaman Utama</a></p>
          <p><a href="#">Syarat &amp; Ketentuan Garansi</a></p>
          <h3>Produk</h3>
          <p><a href="#">Aki Mobil</a></p>
          <p><a href="#">Aki UPS</a></p>
        </div>
        <div class="column">
          <h3>Ikuti Kami</h3>
          <p><a href="#">Facebook</a></p>
          <p><a href="#">Instagram</a></p>
          <p><a href="#">TikTok</a></p>
          <h3>Toko E-Commerce Lain</h3>
          <p><a href="#">Tokopedia</a></p>
        </div>
      </div>
    </div>
    <div class="copyright">Â© 2024 Akikita.id</div>
  </body>
</html>
